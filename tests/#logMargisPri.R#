##' This is the prior settings for the marginal parts
##'
##' <details>
##' @title <short tile>
##' @param parMargis 
##' @return 
##' @references 
##' @author Feng Li, Department of Statistics, Stockholm University, Sweden.
##' @note Created: ; Current: .
logMargisPri <- function(parMargis)
  {
    ## TODO: Now (Sun Oct 23 19:17:24 CEST 2011) we assume there is no
    ## covariates in the marginal expressions, but still we need the parameters
    ## for e.g. mean and standard deviation for the Gaussian

    p <- length(parMargis) # no. of margins
    margisOut <- numeric(p) # The output of each log likelihood marginal density
    
    for(i in 1:p)
      {
        marginType <- parMargis[[i]][["type"]]        
        if(tolower(marginType) == "gaussian")
          {
            ## The mean and standard deviation for Gaussian density
            mu <- parMargis[[i]][["mu"]] # n-by-1
            sigma <- parMargis[[i]][["sigma"]]   # n-by-1     
            
            ## Set prior on mean and standard deviation TODO: The idea is to
            ## set the prior on the top level parameters in the margins and map
            ## it to the corresponding parameters as in Villani(2011) did.

            dmu <- dnorm(mu, mean = 0, sd = 1, log = TRUE)
            dsigma <- dnorm(sigma, mean = 0.5, sd = 1, log = TRUE)
            
            
            ## The log density for the prior
            margisOut[i] <- dmu + dsigma
          }
      }
    
    out <- sum(margisOut)
    return(out)
  }
